{# src/DATA/DataBundle/Resources/views/Artwork/index.html.twig #}
 
{% extends "AdminBundle::layout.html.twig" %}

{% block title %}
    Home - {{ parent() }}
{% endblock %} 
    
{% block h1 %}
    Home
{% endblock %}

{% block breadcrumb %}
    {{ parent() }}
    <li class="active">Sessions</li>
{% endblock %}

{% block h1_extend %}
    <a class="btn btn-primary" href="{{ path('admin_graph_index') }}">View Graph</a>
    <a class="btn btn-primary" href="{{ path('admin_entity_insert') }}">Insert Fetch</a>
    <a class="btn btn-primary" href="{{ path('admin_entity_viewWaitingFetch') }}">Waiting Fetch</a>
{% endblock %}
    
{% block content %}
    <div class="row">
        <section class="col-md-12">
            {% for flashMessage in app.session.flashbag.get('notice') %}
                <div class="alert col-md-12 alert-success">
                    {{ flashMessage }}
                </div>
                <br />
            {% endfor %}

            <table class="table table-striped table-bordered">
                <caption>{{ sessions.getTotalItemCount }} sessions</caption>
                <tr>
                    <th>#</th>
                    <th>User</th>
                    <th>Context</th>
                    <th>Date</th>
                </tr>
                {% for session in sessions %}
                    <tr>
                        <td>{{ ((sessions.getPaginationData.current-1)*100)+loop.index }}</td>
                        <td>
                            {% if session.context == "facebook_messenger" %}
                            <dl class="dl-horizontal">
                                <dt>Fb ID</dt>
                                <dd>{{ session.createUserFacebookId }}</dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt>Fb Locale</dt>
                                <dd>{{ session.createUserFacebookLocale }}</dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt>Fb Ref</dt>
                                <dd>{{ session.createUserFacebookRef }}</dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt>Fb Timezone</dt>
                                <dd>{{ session.createUserFacebookTimezone }}</dd>
                            </dl>
                            {% endif %}
                        </td>
                        <td>{{ session.context }}</td>
                        <td>{{ session.createDate|date('m-d-Y') }}</td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="4">No sessions</td>
                    </tr>
                {% endfor %}
            </table>
            <div class="text-center">{{ knp_pagination_render(sessions) }}</div>
        </section>
    </div>
{% endblock %}